<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="log4net" type="log4net.Config.Log4NetConfigurationSectionHandler,log4net, Version=1.2.10.0, Culture=neutral, PublicKeyToken=f9333ee20f7311a1" />
  </configSections>
    <appSettings>
	<add key="usersExcelPath" value ="D:\Manasa\Onvia_TFS\Atlas\Onvia.Glengarry.Search_Automation\users.xls"/>
    <add key="GlengarryDBConnection" value="Data Source=seaqoodsql0.onviaweb.prod;Initial Catalog=Glengarry;Integrated Security=SSPI; Connection Timeout=120" />
    <add key="excelConnectionstring" value="Provider=Microsoft.Jet.OLEDB.4.0;Data Source={0};Extended Properties=Excel 8.0;"/>
  </appSettings>
  <system.web>
  </system.web>
  <system.serviceModel>
    <bindings>onsit
      <wsHttpBinding>
        <!--WSHttpBinding Config for Login Service-->
        <binding name="WSHttpBinding_ILogin" closeTimeout="00:10:00"
						 openTimeout="00:10:00" receiveTimeout="00:10:00" sendTimeout="00:10:00"
						 bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
						 maxBufferPoolSize="2147483647" maxReceivedMessageSize="2147483647" messageEncoding="Text"
						 textEncoding="utf-8" useDefaultWebProxy="true" allowCookies="false">
          <readerQuotas maxDepth="32" maxStringContentLength="2147483647" maxArrayLength="2147483647"
							   maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
							   enabled="false" />
          <security mode="Message">
            <transport clientCredentialType="Windows" proxyCredentialType="None"
									 realm="" />
            <message clientCredentialType="Windows" negotiateServiceCredential="true"
									 algorithmSuite="Default" establishSecurityContext="true" />
          </security>
        </binding>

        <!--WSHttpBinding Config for Search Service-->
        <binding name="WSHttpBinding_ISearch" closeTimeout="00:10:00"
							openTimeout="00:10:00" receiveTimeout="00:20:00" sendTimeout="00:20:00"
                    bypassProxyOnLocal="false" transactionFlow="false" hostNameComparisonMode="StrongWildcard"
                    maxBufferPoolSize="524288" maxReceivedMessageSize="2147483647"
                    messageEncoding="Text" textEncoding="utf-8" useDefaultWebProxy="true"
                    allowCookies="false">
          <readerQuotas maxDepth="32" maxStringContentLength="2147483647" maxArrayLength="2147483647"
                        maxBytesPerRead="2147483647" maxNameTableCharCount="16384" />
          <reliableSession ordered="true" inactivityTimeout="00:20:00" enabled="false" />
          <security mode="Message">
            <transport clientCredentialType="Windows" proxyCredentialType="None"
                            realm="" />
            <message clientCredentialType="Windows" negotiateServiceCredential="true"
                            algorithmSuite="Default" establishSecurityContext="true" />
          </security>
        </binding>
      </wsHttpBinding>

      <netTcpBinding>
        <!--NetTcpBinding Config for Login Service-->
        <binding name="NetTcpBinding_ILogin" closeTimeout="00:01:00"
					openTimeout="00:01:00" receiveTimeout="00:10:00" sendTimeout="00:01:00"
					transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
					hostNameComparisonMode="StrongWildcard" listenBacklog="10"
					maxBufferPoolSize="2147483647" maxBufferSize="2147483647" maxConnections="512"
					maxReceivedMessageSize="2147483647">
          <readerQuotas maxDepth="32" maxStringContentLength="2147483647" maxArrayLength="2147483647"
						maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
          <reliableSession ordered="true" inactivityTimeout="00:10:00"
						enabled="false" />
          <security mode="Transport">
            <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
            <message clientCredentialType="Windows" />
          </security>
        </binding>

        <!--NetTcpBinding Config for Search Service-->
        <binding name="NetTcpBinding_ISearch" closeTimeout="00:10:00"
							openTimeout="00:10:00" receiveTimeout="00:20:00" sendTimeout="00:20:00"
                    transactionFlow="false" transferMode="Buffered" transactionProtocol="OleTransactions"
                    hostNameComparisonMode="StrongWildcard" listenBacklog="10"
                    maxBufferPoolSize="524288" maxBufferSize="2147483647" maxConnections="512"
                    maxReceivedMessageSize="2147483647">
          <readerQuotas maxDepth="2147483647" maxStringContentLength="2147483647" maxArrayLength="2147483647"
								  maxBytesPerRead="2147483647" maxNameTableCharCount="2147483647" />
          <reliableSession ordered="true" inactivityTimeout="00:20:00" enabled="false" />
          <security mode="Transport">
            <transport clientCredentialType="Windows" protectionLevel="EncryptAndSign" />
            <message clientCredentialType="Windows" />
          </security>
        </binding>
      </netTcpBinding>
    </bindings>
    <behaviors>
      <endpointBehaviors>
        <behavior name ="Onvia.ContentServiceBehaviour"  >
          <dataContractSerializer maxItemsInObjectGraph ="2147483647"/>
        </behavior>
      </endpointBehaviors>
    </behaviors>
    <client>
      <!--Login Service End Points-->
      <endpoint address="net.tcp://services.qa.onvia.com/glengarry/Login.svc"
					 binding="netTcpBinding" bindingConfiguration="NetTcpBinding_ILogin"
					 contract="ILogin" name="NetTcpBinding_ILogin">
        <identity>
          <userPrincipalName value="" />
        </identity>
      </endpoint>

      <endpoint address="http://services.qa.onvia.com/glengarry/Login.svc"
				   binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_ILogin"
				   contract="ILogin" name="WSHttpBinding_ILogin">
        <identity>
          <dns value="localhost" />
        </identity>
      </endpoint>

      <!--Search Service End Points-->
      <endpoint address="net.tcp://services.qa.onvia.com/vcesearch/Search.svc"
			   binding="netTcpBinding" bindingConfiguration="NetTcpBinding_ISearch"
			   contract="ISearch" name="NetTcpBinding_ISearch">
        <identity>
          <userPrincipalName value="" />
        </identity>
      </endpoint>

      <endpoint address="http://services.qa.onvia.com/vcesearch/Search.svc"
                binding="wsHttpBinding" bindingConfiguration="WSHttpBinding_ISearch"
                contract="ISearch" name="WSHttpBinding_ISearch">
        <identity>
          <dns value="localhost" />
        </identity>
      </endpoint>
    </client>
  </system.serviceModel>

  <log4net>
    <appender name="RollingFileAppender" type="log4net.Appender.RollingFileAppender">
      <file value="D:\Logfiles\Glengarry SearchAutomation\SearchAutomation.log"/>
      <appendToFile value="true"/>
      <rollingStyle value="Composite"/>
      <datePattern value="yyyyMMdd"/>
      <staticLogFileName value="true"/>
      <maximumFileSize value="10MB"/>
      <maxSizeRollBackups value="50"/>
      <staticLogFileName value="true"/>
      <filter type="log4net.Filter.LevelRangeFilter">
        <acceptOnMatch value="true"/>
        <levelMin value="DEBUG"/>
        <levelMax value="FATAL"/>
      </filter>
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%d [%t] %-5p : %m%n"/>
      </layout>
      <threshold value="DEBUG"/>
    </appender>
    <appender name="ConsoleAppender" type="log4net.Appender.ConsoleAppender">
      <layout type="log4net.Layout.PatternLayout">
        <param name="ConversionPattern" value="%d [%t] %-5p : %m%n"/>
      </layout>
    </appender>

    <appender name="EventLogAppender" type="log4net.Appender.EventLogAppender">
      <param name="logName" value="Application" />
      <param name="applicationName" value="DataVisualizationService" />
      <layout type="log4net.Layout.PatternLayout">
        <conversionPattern value="%m%n" />
      </layout>
      <filter type="log4net.Filter.LevelRangeFilter">
        <acceptOnMatch value="true"/>
        <levelMin value="INFO"/>
        <levelMax value="FATAL"/>
      </filter>
    </appender>

    <root>
      <level value="DEBUG"/>
      <appender-ref ref="RollingFileAppender"/>
      <appender-ref ref="ConsoleAppender"/>
      <appender-ref ref="EventLogAppender"/>
    </root>
  </log4net>

</configuration>
